<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë°±ì—”ë“œ API í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h2 { color: #333; }
    section { margin-bottom: 20px; }
    button { margin: 5px; padding: 10px 20px; }
    #output { border: 1px solid #ccc; padding: 10px; min-height: 100px; background: #f9f9f9; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>ë°±ì—”ë“œ API í…ŒìŠ¤íŠ¸ í˜ì´ì§€</h1>
  
  <!-- ìœ ì € í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
  <section>
    <h2>ìœ ì € í…ŒìŠ¤íŠ¸</h2>
    <button id="createUser">ìœ ì € ìƒì„±</button>
    <button id="getUser">ìœ ì € ì¡°íšŒ</button>
    <button id="updateUser">ìœ ì € ìˆ˜ì •</button>
    <button id="deleteUser">ìœ ì € ì‚­ì œ</button>
  </section>
  
  <!-- ê²Œì‹œê¸€ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
  <section>
    <h2>ê²Œì‹œê¸€ í…ŒìŠ¤íŠ¸</h2>
    <button id="createPost">ê²Œì‹œê¸€ ìƒì„±</button>
    <button id="getPost">ê²Œì‹œê¸€ ì¡°íšŒ</button>
    <button id="updatePost">ê²Œì‹œê¸€ ìˆ˜ì •</button>
    <button id="deletePost">ê²Œì‹œê¸€ ì‚­ì œ</button>
  </section>
  
  <!-- ëŒ“ê¸€ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
  <section>
    <h2>ëŒ“ê¸€ í…ŒìŠ¤íŠ¸</h2>
    <button id="createComment">ëŒ“ê¸€ ìƒì„±</button>
    <button id="getComment">ëŒ“ê¸€ ì¡°íšŒ</button>
    <button id="updateComment">ëŒ“ê¸€ ìˆ˜ì •</button>
    <button id="deleteComment">ëŒ“ê¸€ ì‚­ì œ</button>
  </section>
  
  <!-- ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
  <section>
    <h2>ì•Œë¦¼ í…ŒìŠ¤íŠ¸</h2>
    <button id="createNotification">ì•Œë¦¼ ìƒì„±</button>
    <button id="getNotification">ì•Œë¦¼ ì¡°íšŒ</button>
    <button id="updateNotification">ì•Œë¦¼ ìˆ˜ì •</button>
    <button id="deleteNotification">ì•Œë¦¼ ì‚­ì œ</button>
  </section>
    
    <!-- ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ ì„¹ì…˜ -->
  <section>
    <h2>ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h2>
    <label for="emailInput">ì´ë©”ì¼: </label>
    <input type="email" id="emailInput" placeholder="user@example.com" />
    <label for="pwInput">ë¹„ë°€ë²ˆí˜¸: </label>
    <input type="password" id="pwInput" placeholder="password" />
    <button id="loginUser">ë¡œê·¸ì¸ ì‹œë„</button>
  </section>

  
  <!-- ê²°ê³¼ ì¶œë ¥ ì˜ì—­ -->
  <section>
    <h2>ì¶œë ¥ ê²°ê³¼</h2>
    <pre id="output"></pre>
  </section>
  
  <script>
    const output = document.getElementById('output');

    // API ê¸°ë³¸ URL (í•„ìš”ì— ë”°ë¼ ìˆ˜ì •)
    const API_BASE = '/api';

    // ê° í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©ë  ë°ì´í„° ì €ì¥
    let testUser = null;
    let testPost = null;
    let testComment = null;
    let testNotification = null;

    // API ìš”ì²­ í•¨ìˆ˜ (Fetch ì‚¬ìš©)
    async function request(url, method, data = null) {
      const options = {
        method,
        headers: { 'Content-Type': 'application/json' }
      };
      if (data) options.body = JSON.stringify(data);
      
      try {
        const res = await fetch(url, options);
        const json = await res.json();
        return json;
      } catch (err) {
        return { error: err.toString() };
      }
    }

    /*------- ìœ ì € í…ŒìŠ¤íŠ¸ -------*/
    document.getElementById('createUser').addEventListener('click', async () => {
      const userData = {
        userName: 'í…ŒìŠ¤íŠ¸ ìœ ì €',
        userEmail: 'test@example.com',
        userPW: 'password',
        userIntro: 'í…ŒìŠ¤íŠ¸ìš© ìê¸°ì†Œê°œ',
        representatives: ['1234.123', '2345.345'],
        hashTags: ['MLDL', 'CV', 'NLP', 'RL']
      };
      testUser = await request(`${API_BASE}/users`, 'POST', userData);
      output.textContent = 'ìœ ì € ìƒì„± ê²°ê³¼:\n' + JSON.stringify(testUser, null, 2);
    });

    document.getElementById('getUser').addEventListener('click', async () => {
      if (!testUser || !testUser.userID) {
        output.textContent = 'ë¨¼ì € ìœ ì €ë¥¼ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const user = await request(`${API_BASE}/users/${testUser.userID}`, 'GET');
      output.textContent = 'ìœ ì € ì¡°íšŒ ê²°ê³¼:\n' + JSON.stringify(user, null, 2);
    });

    document.getElementById('updateUser').addEventListener('click', async () => {
      if (!testUser || !testUser.userID) {
        output.textContent = 'ë¨¼ì € ìœ ì €ë¥¼ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const updatedData = { userIntro: 'ìˆ˜ì •ëœ ìê¸°ì†Œê°œ' };
      testUser = await request(`${API_BASE}/users/${testUser.userID}`, 'PUT', updatedData);
      output.textContent = 'ìœ ì € ìˆ˜ì • ê²°ê³¼:\n' + JSON.stringify(testUser, null, 2);
    });

    document.getElementById('deleteUser').addEventListener('click', async () => {
      if (!testUser || !testUser.userID) {
        output.textContent = 'ë¨¼ì € ìœ ì €ë¥¼ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const result = await request(`${API_BASE}/users/${testUser.userID}`, 'DELETE');
      output.textContent = 'ìœ ì € ì‚­ì œ ê²°ê³¼:\n' + JSON.stringify(result, null, 2);
      testUser = null;
    });

    /*------- ê²Œì‹œê¸€ í…ŒìŠ¤íŠ¸ -------*/
    document.getElementById('createPost').addEventListener('click', async () => {
      if (!testUser || !testUser.userID) {
        output.textContent = 'ë¨¼ì € ìœ ì €ë¥¼ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.';
        return;
      }
      const postData = {
        userID: testUser.userID,
        userName: testUser.userName,
        postTitle: 'í…ŒìŠ¤íŠ¸ ê²Œì‹œê¸€',
        postContent: 'ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ ê²Œì‹œê¸€ì˜ ë‚´ìš©ì…ë‹ˆë‹¤.',
        hashTags: ['í…ŒìŠ¤íŠ¸', 'API']
      };
      testPost = await request(`${API_BASE}/posts`, 'POST', postData);
      output.textContent = 'ê²Œì‹œê¸€ ìƒì„± ê²°ê³¼:\n' + JSON.stringify(testPost, null, 2);
    });

    document.getElementById('getPost').addEventListener('click', async () => {
      if (!testPost || !testPost.postID) {
        output.textContent = 'ë¨¼ì € ê²Œì‹œê¸€ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const post = await request(`${API_BASE}/posts/${testPost.postID}`, 'GET');
      output.textContent = 'ê²Œì‹œê¸€ ì¡°íšŒ ê²°ê³¼:\n' + JSON.stringify(post, null, 2);
    });

    document.getElementById('updatePost').addEventListener('click', async () => {
      if (!testPost || !testPost.postID) {
        output.textContent = 'ë¨¼ì € ê²Œì‹œê¸€ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const updatedData = { postContent: 'ìˆ˜ì •ëœ ê²Œì‹œê¸€ ë‚´ìš©ì…ë‹ˆë‹¤.' };
      testPost = await request(`${API_BASE}/posts/${testPost.postID}`, 'PUT', updatedData);
      output.textContent = 'ê²Œì‹œê¸€ ìˆ˜ì • ê²°ê³¼:\n' + JSON.stringify(testPost, null, 2);
    });

    document.getElementById('deletePost').addEventListener('click', async () => {
      if (!testPost || !testPost.postID) {
        output.textContent = 'ë¨¼ì € ê²Œì‹œê¸€ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const result = await request(`${API_BASE}/posts/${testPost.postID}`, 'DELETE');
      output.textContent = 'ê²Œì‹œê¸€ ì‚­ì œ ê²°ê³¼:\n' + JSON.stringify(result, null, 2);
      testPost = null;
    });

    /*------- ëŒ“ê¸€ í…ŒìŠ¤íŠ¸ -------*/
    document.getElementById('createComment').addEventListener('click', async () => {
      if (!testUser || !testUser.userID) {
        output.textContent = 'ìœ ì €ë¥¼ ë¨¼ì € ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.';
        return;
      }
      if (!testPost || !testPost.postID) {
        output.textContent = 'ê²Œì‹œê¸€ì„ ë¨¼ì € ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.';
        return;
      }
      const commentData = {
        postID: testPost.postID,
        userID: testUser.userID,
        comment: 'ì´ê²ƒì€ í…ŒìŠ¤íŠ¸ ëŒ“ê¸€ì…ë‹ˆë‹¤.'
      };
      testComment = await request(`${API_BASE}/comments`, 'POST', commentData);
      output.textContent = 'ëŒ“ê¸€ ìƒì„± ê²°ê³¼:\n' + JSON.stringify(testComment, null, 2);
    });

    document.getElementById('getComment').addEventListener('click', async () => {
      if (!testComment || !testComment.commentID) {
        output.textContent = 'ë¨¼ì € ëŒ“ê¸€ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const comment = await request(`${API_BASE}/comments/${testComment.commentID}`, 'GET');
      output.textContent = 'ëŒ“ê¸€ ì¡°íšŒ ê²°ê³¼:\n' + JSON.stringify(comment, null, 2);
    });

    document.getElementById('updateComment').addEventListener('click', async () => {
      if (!testComment || !testComment.commentID) {
        output.textContent = 'ë¨¼ì € ëŒ“ê¸€ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const updatedData = { comment: 'ìˆ˜ì •ëœ ëŒ“ê¸€ ë‚´ìš©ì…ë‹ˆë‹¤.' };
      testComment = await request(`${API_BASE}/comments/${testComment.commentID}`, 'PUT', updatedData);
      output.textContent = 'ëŒ“ê¸€ ìˆ˜ì • ê²°ê³¼:\n' + JSON.stringify(testComment, null, 2);
    });

    document.getElementById('deleteComment').addEventListener('click', async () => {
      if (!testComment || !testComment.commentID) {
        output.textContent = 'ë¨¼ì € ëŒ“ê¸€ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const result = await request(`${API_BASE}/comments/${testComment.commentID}`, 'DELETE');
      output.textContent = 'ëŒ“ê¸€ ì‚­ì œ ê²°ê³¼:\n' + JSON.stringify(result, null, 2);
      testComment = null;
    });

    /*------- ì•Œë¦¼ í…ŒìŠ¤íŠ¸ -------*/
    document.getElementById('createNotification').addEventListener('click', async () => {
      if (!testUser || !testUser.userID) {
        output.textContent = 'ìœ ì €ë¥¼ ë¨¼ì € ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.';
        return;
      }
      const notiData = {
        userID: testUser.userID,
        message: 'í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë©”ì‹œì§€'
      };
      testNotification = await request(`${API_BASE}/notifications`, 'POST', notiData);
      output.textContent = 'ì•Œë¦¼ ìƒì„± ê²°ê³¼:\n' + JSON.stringify(testNotification, null, 2);
    });

    document.getElementById('getNotification').addEventListener('click', async () => {
      if (!testNotification || !testNotification.notificationID) {
        output.textContent = 'ë¨¼ì € ì•Œë¦¼ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const noti = await request(`${API_BASE}/notifications/${testNotification.notificationID}`, 'GET');
      output.textContent = 'ì•Œë¦¼ ì¡°íšŒ ê²°ê³¼:\n' + JSON.stringify(noti, null, 2);
    });

    document.getElementById('updateNotification').addEventListener('click', async () => {
      if (!testNotification || !testNotification.notificationID) {
        output.textContent = 'ë¨¼ì € ì•Œë¦¼ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const updatedData = { message: 'ìˆ˜ì •ëœ ì•Œë¦¼ ë©”ì‹œì§€' };
      testNotification = await request(`${API_BASE}/notifications/${testNotification.notificationID}`, 'PUT', updatedData);
      output.textContent = 'ì•Œë¦¼ ìˆ˜ì • ê²°ê³¼:\n' + JSON.stringify(testNotification, null, 2);
    });

    document.getElementById('deleteNotification').addEventListener('click', async () => {
      if (!testNotification || !testNotification.notificationID) {
        output.textContent = 'ë¨¼ì € ì•Œë¦¼ì„ ìƒì„±í•˜ì„¸ìš”.';
        return;
      }
      const result = await request(`${API_BASE}/notifications/${testNotification.notificationID}`, 'DELETE');
      output.textContent = 'ì•Œë¦¼ ì‚­ì œ ê²°ê³¼:\n' + JSON.stringify(result, null, 2);
      testNotification = null;
    });
      
  // ğŸ” ë¡œê·¸ì¸ ì‹œë„
    document.getElementById('loginUser').addEventListener('click', async () => {
      const email = document.getElementById('emailInput').value.trim();
      const password = document.getElementById('pwInput').value.trim();

      if (!email || !password) {
        output.textContent = 'ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
        return;
      }

      const loginResult = await request(`${API_BASE}/users/login`, 'POST', {
        userEmail: email,
        userPW: password
      });

      if (loginResult.userID) {
        output.textContent = 'âœ… ë¡œê·¸ì¸ ì„±ê³µ!\n' + JSON.stringify(loginResult, null, 2);
        testUser = loginResult; // ë¡œê·¸ì¸ì— ì„±ê³µí•œ ìœ ì €ë¥¼ testUserë¡œ ì €ì¥
      } else {
        output.textContent = 'âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨:\n' + JSON.stringify(loginResult, null, 2);
      }
    });

  </script>
</body>
</html>
 